processing:
  # Enable the usage of MISP queries in pre and post processing for
  # the discovered IOCs.
  enabled: False

  # The MISP API url. Is also used as the base URL for creating links to
  # events.
  url: null

  # Verify if the configured MISP server is using a valid TLS certificate.
  # Disable this your certificate is self-signed or no certificate is used.
  verify_tls: True

  # The API key to access the MISP api.
  key: null

  # A connection timeout to use when using the MISP api.
  timeout: 5

  # Settings for pre-processing
  pre:
    # The maximum amount of events that should be asked from MISP per query.
    event_limit: 1
    #To restrict the returned data set to to_ids only attributes set this parameter to 1
    query_ids_flag: 1
    # Filter on eventâ€™s publish timestamp.
    publish_timestamp: 365d

    file:
      # What target file hashes to use when searching for MISP events.
      # Supported: md5, sha1, sha256, sha512
      hashes:
      - sha256

  # Settings for post behavioral processing.
  post:
    # The maximum amount of queries to perform per IOC type.
    # Currently supported: dst_ip, domain, url
    query_limits:
      dst_ip: 10
      domain: 10
      url: 10

    # The maximum amount of events for each IOC type that should be
    # asked from MISP per query.
    event_limits:
      dst_ip: 1
      domain: 1
      url: 1

    # To restrict the returned data set to to_ids only attributes
    query_ids_flags:
      dst_ip: 1
      domain: 1
      url: 1

    # To restrict the returned data set by publish_timestamp
    publish_timestamps:
      dst_ip: 365d
      domain: 365d
      url: 365d

reporting:
  # Enable the reporting of discovered IOCs as a new event.
  enabled: False

  # The MISP API url. Is also used as the base URL for creating links to
  # events.
  url: null

  # Verify if the configured MISP server is using a valid TLS certificate.
  # Disable this your certificate is self-signed or no certificate is used.
  verify_tls: True

  # The API key to access the MISP api.
  key: null

  # A connection timeout to use when using the MISP api.
  timeout: 5

  # The minimum Cuckoo score a task must have before discovered
  # IOCs are reported to MISP.
  min_score: 7

  # The base URL of your running Cuckoo web instance. This is used to create
  # links to reported tasks.
  web_baseurl: null

  event:
    # Distribution controls who will be able to see the event.
    distribution: null
    # The sharing group that should be used if distribution is set to sharing group
    sharing_group: null
    threat_level: null
    analysis: null
    # Add mitre attack TTP tags for the Mitre attack galaxy?
    galaxy_mitre_attack: True
    # Should the event be set to published?
    publish: False

    tags:
    - Cuckoo 3

    attributes:
      ip_addresses:
        include: True
        ids: False
      domains:
        include: True
        ids: False
      urls:
        include: True
        ids: False
      mutexes:
        include: True
        ids: False
      sample_hashes: 
        include: True
        ids: False
        upload_sample: False